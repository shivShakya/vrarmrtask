import*as t from"https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js";import{GLTFLoader as v}from"https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/extras/loaders/GLTFLoader.min.js";import{DRACOLoader as R}from"https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/extras/loaders/DRACOLoader.min.js";import{OrbitControls as C}from"https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/extras/controls/OrbitControls.min.js";import{RGBELoader as S}from"https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/extras/loaders/RGBELoader.min.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))d(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const u of i.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&d(u)}).observe(document,{childList:!0,subtree:!0});function s(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function d(o){if(o.ep)return;o.ep=!0;const i=s(o);fetch(o.href,i)}})();let f,y;const a=[],L=document.getElementById("canvas");L.width=window.innerWidth;L.height=window.innerHeight;const r=new t.Scene,c=new t.PerspectiveCamera(75,window.innerWidth/window.innerHeight,.1,1e3),m=new t.WebGLRenderer({canvas:L});m.setSize(window.innerWidth,window.innerHeight);document.body.appendChild(m.domElement);m.setClearColor("#000000");const W=new S;W.load("back.hdr",function(e){e.mapping=t.EquirectangularReflectionMapping,r.background=e,r.environment=e},void 0,function(e){console.error("Error loading HDR image:",e)});const B=new t.AmbientLight(16777215,.5);r.add(B);const x=new t.DirectionalLight(16777215,1);x.position.set(1,1,1).normalize();r.add(x);const I=new t.HemisphereLight(16777147,526368,1);r.add(I);const z=document.getElementById("loading-bar"),h=new t.LoadingManager;h.onProgress=function(e,n,s){const d=n/s;j(d)};h.onLoad=function(){document.getElementById("loading-bar-container").style.display="none",document.getElementById("canvas").style.display="block"};function j(e){z.style.width=e*100+"%"}const A=new v(h),O=new R(h);O.setDecoderPath("https://www.gstatic.com/draco/v1/decoders/");A.setDRACOLoader(O);A.load("model3.glb",function(e){const n=e.scene;n.scale.setScalar(10),n.position.set(0,0,0),n.rotation.y=Math.PI/2,r.add(n),y=new t.AnimationMixer(n),e.animations.forEach(s=>{const d=y.clipAction(s);a.push(d),a[0].play()}),c.lookAt(n.position)},void 0,function(e){console.error("Error loading 3D model:",e)});const E=new t.BoxGeometry(5,8,5),M=new t.MeshStandardMaterial({color:16711680,opacity:0,transparent:!0}),p=new t.Mesh(E,M);p.name="lower";p.position.set(0,3,0);r.add(p);const w=new t.Mesh(E,M);w.name="middle";w.position.set(0,10,0);r.add(w);const g=new t.Mesh(E,M);g.name="upper";g.position.set(0,16,0);r.add(g);const P=new t.Raycaster,b=new t.Vector2;function F(e){b.x=e.clientX/window.innerWidth*2-1,b.y=-(e.clientY/window.innerHeight)*2+1,P.setFromCamera(b,c);const n=P.intersectObjects([g,w,p],!0);if(n.length>0){const s=n[0].object;s===g&&a.length>=3?(a[2].play(),setTimeout(()=>{a[2].stop()},4e3)):s===w&&a.length>=2?(a[1].play(),setTimeout(()=>{a[1].stop()},4e3)):s===p&&a.length>=1&&(a[0].play(),setTimeout(()=>{a[0].stop()},7e3))}}document.addEventListener("click",F,!1);const D=new v(h);D.load("road.glb",function(e){const n=e.scene;r.add(n),n.scale.setScalar(10)},void 0,function(e){console.error("Error loading 3D model:",e)});const l=new C(c,m.domElement);l.enableDamping=!0;l.dampingFactor=.25;l.enableRotate=!0;l.enableZoom=!0;c.position.set(20,20,-20);l.minDistance=10;l.maxDistance=50;l.minPolarAngle=Math.PI/4;l.maxPolarAngle=Math.PI/2;D.load("hand.glb",e=>{f=e.scene,f.scale.setScalar(10),r.add(f)});function G(e){const n=e.clientX/window.innerWidth*2-1,s=-(e.clientY/window.innerHeight)*2+1,d=new t.Vector3(n,s,.5);d.unproject(c);const o=d.sub(c.position).normalize(),u=c.position.clone().add(o.multiplyScalar(17));f&&f.position.copy(u)}document.addEventListener("mousemove",G,!1);function T(){c.aspect=window.innerWidth/window.innerHeight,c.updateProjectionMatrix(),m.setSize(window.innerWidth,window.innerHeight)}window.addEventListener("resize",T);function H(){requestAnimationFrame(H),y&&y.update(.016),l.update(),m.render(r,c)}H();
